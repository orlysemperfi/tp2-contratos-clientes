
CREATE TABLE BONIFICACIONES
( 
	ID_BONIFICACION      int IDENTITY ( 1,1 ) ,
	DESCRIPCION          varchar(200)  NOT NULL ,
	ID_CONTRATO          int  NULL 
)
go



ALTER TABLE BONIFICACIONES
	ADD CONSTRAINT XPKBONIFICACIONES PRIMARY KEY  CLUSTERED (ID_BONIFICACION ASC)
go



CREATE TABLE CLAUSULAS
( 
	CODIGO_CLAUSULA      char(7)  NOT NULL ,
	DESCRIPCION_CORTA    varchar(50)  NOT NULL ,
	TIPO                 char(1)  NOT NULL ,
	DESCRIPCION          varchar(500)  NOT NULL ,
	FECHA_REGISTRO       datetime  NULL 
)
go



ALTER TABLE CLAUSULAS
	ADD CONSTRAINT XPKCLAUSULAS PRIMARY KEY  CLUSTERED (CODIGO_CLAUSULA ASC)
go



CREATE TABLE CLIENTE
( 
	ID_CLIENTE           integer IDENTITY ( 1,1 ) ,
	RAZON_SOCIAL         varchar(50)  NOT NULL ,
	RUC                  char(11)  NOT NULL ,
	DIRECCION            varchar(100)  NOT NULL ,
	TELEFONO             varchar(7)  NOT NULL ,
	ANEXO                varchar(5)  NULL ,
	TIPO_CLIENTE         char(1)  NOT NULL ,
	ESTADO               bit  NOT NULL 
)
go



ALTER TABLE CLIENTE
	ADD CONSTRAINT XPKCLIENTE PRIMARY KEY  CLUSTERED (ID_CLIENTE ASC)
go



CREATE TABLE CONTRATO
( 
	ID_SOLICITUD         int  NULL ,
	ID_CONTRATO          int IDENTITY ( 1,1 ) ,
	NUMERO_CONTRATO_ADENDA varchar(12)  NULL ,
	ID_TIPO_CONTRATO     int  NULL ,
	ID_SERVICIO          int  NULL ,
	ID_CONTRATOPADRE     int  NULL ,
	FECHA_INICIO         datetime  NOT NULL ,
	FECHA_FIN            datetime  NOT NULL ,
	ESTADO               char(1)  NOT NULL ,
	MONTO_MN             money  NOT NULL ,
	MONTO_ME             money  NULL ,
	CODIGO_MONEDA        char(3)  NULL ,
	FECHA_TERMINO        datetime  NULL ,
	MOTIVO_TERMINO       varchar(300)  NULL ,
	RESPONSABLE_TERMINO  varchar(50)  NULL ,
	TIPO_DOCUMENTO       char(1)  NOT NULL ,
	ID_CLIENTE           integer  NULL 
)
go



ALTER TABLE CONTRATO
	ADD CONSTRAINT XPKCONTRATO PRIMARY KEY  CLUSTERED (ID_CONTRATO ASC)
go



CREATE TABLE CONTRATOS_CLAUSULAS
( 
	CODIGO_CLAUSULA      char(7)  NOT NULL ,
	ID_CONTRATO          int  NOT NULL 
)
go



ALTER TABLE CONTRATOS_CLAUSULAS
	ADD CONSTRAINT XPKCONTRATOS_CLAUSULAS PRIMARY KEY  CLUSTERED (CODIGO_CLAUSULA ASC,ID_CONTRATO ASC)
go



CREATE TABLE CONTRATOS_INDICADORES
( 
	ID_CONTRATO          int  NOT NULL ,
	CODIGO_INDICADOR     char(7)  NOT NULL ,
	VALOR_OBJETIVO       varchar(20)  NOT NULL ,
	VALOR_ALCANZADO      char(18)  NULL ,
	ESTADO               char(1)  NOT NULL 
)
go



ALTER TABLE CONTRATOS_INDICADORES
	ADD CONSTRAINT XPKCONTRATOS_INDICADORES PRIMARY KEY  CLUSTERED (ID_CONTRATO ASC,CODIGO_INDICADOR ASC)
go



CREATE TABLE CONTRATOS_PENALIDADES
( 
	ID_CONTRATO          int  NOT NULL ,
	CODIGO_PENALIDAD     char(7)  NOT NULL 
)
go



ALTER TABLE CONTRATOS_PENALIDADES
	ADD CONSTRAINT XPKCONTRATOS_PENALIDADES PRIMARY KEY  CLUSTERED (ID_CONTRATO ASC,CODIGO_PENALIDAD ASC)
go



CREATE TABLE CONTRATOS_ROLES
( 
	ID_CONTRATO          int  NOT NULL ,
	ID_ROL               int  NOT NULL 
)
go



ALTER TABLE CONTRATOS_ROLES
	ADD CONSTRAINT XPKCONTRATOS_ROLES PRIMARY KEY  CLUSTERED (ID_CONTRATO ASC,ID_ROL ASC)
go



CREATE TABLE ENTREGABLES
( 
	CODIGO_ENTREGABLE    char(7)  NOT NULL ,
	DESCRIPCION          varchar(30)  NOT NULL ,
	FECHA_PACTADA        datetime  NOT NULL ,
	FECHA_ENTREGA        datetime  NULL ,
	RESPONSABLE          varchar(50)  NOT NULL ,
	ESTADO               bit  NOT NULL ,
	ID_CONTRATO          int  NULL ,
	ID_ROL               int  NULL 
)
go



ALTER TABLE ENTREGABLES
	ADD CONSTRAINT XPKENTREGABLES PRIMARY KEY  CLUSTERED (CODIGO_ENTREGABLE ASC)
go



CREATE TABLE GARANTIAS
( 
	ID_GARANTIA          integer IDENTITY ( 1,1 ) ,
	DESCRIPCION          varchar(200)  NULL ,
	ID_CONTRATO          int  NULL 
)
go



ALTER TABLE GARANTIAS
	ADD CONSTRAINT XPKGARANTIAS PRIMARY KEY  CLUSTERED (ID_GARANTIA ASC)
go



CREATE TABLE INCUMPLIMIENTO
( 
	ID_INCUMPLIMIENTO    int  NOT NULL ,
	MOTIVO               varchar(50)  NOT NULL ,
	FECHA                datetime  NOT NULL ,
	ID_CONTRATO          int  NOT NULL ,
	ESTADO               bit  NOT NULL 
)
go



ALTER TABLE INCUMPLIMIENTO
	ADD CONSTRAINT XPKINCUMPLIMIENTO PRIMARY KEY  CLUSTERED (ID_INCUMPLIMIENTO ASC)
go



CREATE TABLE INCUMPLIMIENTO_CLAUSULAS
( 
	ID_INCUMPLIMIENTO    int  NOT NULL ,
	CODIGO_CLAUSULA      char(7)  NOT NULL ,
	ID_CONTRATO          int  NOT NULL 
)
go



ALTER TABLE INCUMPLIMIENTO_CLAUSULAS
	ADD CONSTRAINT XPKINCUMPLIMIENTO_CLAUSULAS PRIMARY KEY  CLUSTERED (ID_INCUMPLIMIENTO ASC,CODIGO_CLAUSULA ASC,ID_CONTRATO ASC)
go



CREATE TABLE INCUMPLIMIENTO_PENALIDADES
( 
	ID_INCUMPLIMIENTO    int  NOT NULL ,
	ID_CONTRATO          int  NOT NULL ,
	CODIGO_PENALIDAD     char(7)  NOT NULL 
)
go



ALTER TABLE INCUMPLIMIENTO_PENALIDADES
	ADD CONSTRAINT XPKINCUMPLIMIENTO_PENALIDADES PRIMARY KEY  CLUSTERED (ID_INCUMPLIMIENTO ASC,ID_CONTRATO ASC,CODIGO_PENALIDAD ASC)
go



CREATE TABLE INDICADORES
( 
	CODIGO_INDICADOR     char(7)  NOT NULL ,
	DESCRIPCION          varchar(50)  NOT NULL ,
	FRECUENCIA           char(1)  NOT NULL 
)
go



ALTER TABLE INDICADORES
	ADD CONSTRAINT XPKINDICADORES PRIMARY KEY  CLUSTERED (CODIGO_INDICADOR ASC)
go



CREATE TABLE LINEA_SERVICIO
( 
	ID_LINEA_SERVICIO    int IDENTITY ( 1,1 ) ,
	NOMBRE               varchar(40)  NOT NULL 
)
go



ALTER TABLE LINEA_SERVICIO
	ADD CONSTRAINT XPKLINEA_SERVICIO PRIMARY KEY  CLUSTERED (ID_LINEA_SERVICIO ASC)
go



CREATE TABLE MONEDA
( 
	CODIGO_MONEDA        char(3)  NOT NULL ,
	NOMBRE               char(18)  NULL 
)
go



ALTER TABLE MONEDA
	ADD CONSTRAINT XPKMONEDA PRIMARY KEY  CLUSTERED (CODIGO_MONEDA ASC)
go



CREATE TABLE PENALIDADES
( 
	CODIGO_PENALIDAD     char(7)  NOT NULL ,
	DESCRIPCION          varchar(50)  NULL ,
	PORCENTAJE           char(18)  NULL ,
	ESTADO               char(18)  NULL ,
	CODIGO_MONEDA        char(3)  NOT NULL ,
	ID_TIPO_PENALIDAD    integer  NULL ,
	FECHA_REGISTRO       datetime  NOT NULL 
)
go



ALTER TABLE PENALIDADES
	ADD CONSTRAINT XPKPENALIDADES PRIMARY KEY  CLUSTERED (CODIGO_PENALIDAD ASC)
go



CREATE TABLE ROLES
( 
	ID_ROL               int IDENTITY ( 1,1 ) ,
	NOMBRE               varchar(30)  NOT NULL 
)
go



ALTER TABLE ROLES
	ADD CONSTRAINT XPKROLES PRIMARY KEY  CLUSTERED (ID_ROL ASC)
go



CREATE TABLE SERVICIO
( 
	ID_LINEA_SERVICIO    int  NOT NULL ,
	ID_SERVICIO          int IDENTITY ( 1,1 ) ,
	NOMBRE               varchar(40)  NOT NULL 
)
go



ALTER TABLE SERVICIO
	ADD CONSTRAINT XPKSERVICIO PRIMARY KEY  CLUSTERED (ID_SERVICIO ASC)
go



CREATE TABLE SOLICITUD
( 
	ID_SOLICITUD         int IDENTITY ( 1,1 ) ,
	NUMERO_SOLICITUD     varchar(10)  NULL ,
	FECHA_REGISTRO       datetime  NULL ,
	ESTADO               varchar(20)  NULL ,
	TIPO_SOLICITUD       char(1)  NULL ,
	DESCRIPCION          varchar(100)  NULL ,
	MOTIVO_RECHAZO       varchar(100)  NULL ,
	NUMERO_BUENA_PRO     varchar(15)  NULL ,
	NUMERO_CARTA_FIANZA  varchar(15)  NULL ,
	ID_CONTRATO          int  NULL ,
	CLIENTE_TIPO         char(1)  NULL ,
	CLIENTE_RAZON_SOCIAL varchar(50)  NULL ,
	CLIENTE_RUC          char(11)  NULL ,
	CLIENTE_DIRECCION    varchar(150)  NULL ,
	CLIENTE_TELEFONO     varchar(20)  NULL ,
	CLIENTE_ANEXO        varchar(10)  NULL 
)
go



ALTER TABLE SOLICITUD
	ADD CONSTRAINT XPKSOLICITUD PRIMARY KEY  CLUSTERED (ID_SOLICITUD ASC)
go



CREATE TABLE TIPO_CONTRATO
( 
	ID_TIPO_CONTRATO     int IDENTITY ( 1,1 ) ,
	NOMBRE               varchar(20)  NOT NULL 
)
go



ALTER TABLE TIPO_CONTRATO
	ADD CONSTRAINT XPKTIPO_CONTRATO PRIMARY KEY  CLUSTERED (ID_TIPO_CONTRATO ASC)
go



CREATE TABLE TIPO_PENALIDAD
( 
	DESCRIPCION          varchar(35)  NOT NULL ,
	ESTADO               char(1)  NOT NULL ,
	ID_TIPO_PENALIDAD    integer IDENTITY ( 1,1 ) 
)
go



ALTER TABLE TIPO_PENALIDAD
	ADD CONSTRAINT XPKTIPO_PENALIDAD PRIMARY KEY  NONCLUSTERED (ID_TIPO_PENALIDAD ASC)
go




ALTER TABLE BONIFICACIONES
	ADD CONSTRAINT R_17 FOREIGN KEY (ID_CONTRATO) REFERENCES CONTRATO(ID_CONTRATO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go




ALTER TABLE CONTRATO
	ADD CONSTRAINT R_5 FOREIGN KEY (ID_SOLICITUD) REFERENCES SOLICITUD(ID_SOLICITUD)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go




ALTER TABLE CONTRATO
	ADD CONSTRAINT R_8 FOREIGN KEY (ID_TIPO_CONTRATO) REFERENCES TIPO_CONTRATO(ID_TIPO_CONTRATO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go




ALTER TABLE CONTRATO
	ADD CONSTRAINT R_12 FOREIGN KEY (ID_SERVICIO) REFERENCES SERVICIO(ID_SERVICIO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go




ALTER TABLE CONTRATO
	ADD CONSTRAINT R_39 FOREIGN KEY (CODIGO_MONEDA) REFERENCES MONEDA(CODIGO_MONEDA)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go




ALTER TABLE CONTRATO
	ADD CONSTRAINT R_41 FOREIGN KEY (ID_CONTRATOPADRE) REFERENCES CONTRATO(ID_CONTRATO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go




ALTER TABLE CONTRATO
	ADD CONSTRAINT R_42 FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTE(ID_CLIENTE)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go




ALTER TABLE CONTRATOS_CLAUSULAS
	ADD CONSTRAINT R_22 FOREIGN KEY (CODIGO_CLAUSULA) REFERENCES CLAUSULAS(CODIGO_CLAUSULA)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go




ALTER TABLE CONTRATOS_CLAUSULAS
	ADD CONSTRAINT R_32 FOREIGN KEY (ID_CONTRATO) REFERENCES CONTRATO(ID_CONTRATO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go




ALTER TABLE CONTRATOS_INDICADORES
	ADD CONSTRAINT R_21 FOREIGN KEY (ID_CONTRATO) REFERENCES CONTRATO(ID_CONTRATO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go




ALTER TABLE CONTRATOS_INDICADORES
	ADD CONSTRAINT R_23 FOREIGN KEY (CODIGO_INDICADOR) REFERENCES INDICADORES(CODIGO_INDICADOR)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go




ALTER TABLE CONTRATOS_PENALIDADES
	ADD CONSTRAINT R_24 FOREIGN KEY (ID_CONTRATO) REFERENCES CONTRATO(ID_CONTRATO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go




ALTER TABLE CONTRATOS_PENALIDADES
	ADD CONSTRAINT R_25 FOREIGN KEY (CODIGO_PENALIDAD) REFERENCES PENALIDADES(CODIGO_PENALIDAD)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go




ALTER TABLE CONTRATOS_ROLES
	ADD CONSTRAINT R_18 FOREIGN KEY (ID_CONTRATO) REFERENCES CONTRATO(ID_CONTRATO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go




ALTER TABLE CONTRATOS_ROLES
	ADD CONSTRAINT R_19 FOREIGN KEY (ID_ROL) REFERENCES ROLES(ID_ROL)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go




ALTER TABLE ENTREGABLES
	ADD CONSTRAINT R_29 FOREIGN KEY (ID_CONTRATO,ID_ROL) REFERENCES CONTRATOS_ROLES(ID_CONTRATO,ID_ROL)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go




ALTER TABLE GARANTIAS
	ADD CONSTRAINT R_16 FOREIGN KEY (ID_CONTRATO) REFERENCES CONTRATO(ID_CONTRATO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go




ALTER TABLE INCUMPLIMIENTO
	ADD CONSTRAINT R_30 FOREIGN KEY (ID_CONTRATO) REFERENCES CONTRATO(ID_CONTRATO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go




ALTER TABLE INCUMPLIMIENTO_CLAUSULAS
	ADD CONSTRAINT R_33 FOREIGN KEY (ID_INCUMPLIMIENTO) REFERENCES INCUMPLIMIENTO(ID_INCUMPLIMIENTO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go




ALTER TABLE INCUMPLIMIENTO_CLAUSULAS
	ADD CONSTRAINT R_34 FOREIGN KEY (CODIGO_CLAUSULA,ID_CONTRATO) REFERENCES CONTRATOS_CLAUSULAS(CODIGO_CLAUSULA,ID_CONTRATO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go




ALTER TABLE INCUMPLIMIENTO_PENALIDADES
	ADD CONSTRAINT R_36 FOREIGN KEY (ID_INCUMPLIMIENTO) REFERENCES INCUMPLIMIENTO(ID_INCUMPLIMIENTO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go




ALTER TABLE INCUMPLIMIENTO_PENALIDADES
	ADD CONSTRAINT R_37 FOREIGN KEY (ID_CONTRATO,CODIGO_PENALIDAD) REFERENCES CONTRATOS_PENALIDADES(ID_CONTRATO,CODIGO_PENALIDAD)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go




ALTER TABLE PENALIDADES
	ADD CONSTRAINT R_4 FOREIGN KEY (CODIGO_MONEDA) REFERENCES MONEDA(CODIGO_MONEDA)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go




ALTER TABLE PENALIDADES
	ADD CONSTRAINT R_15 FOREIGN KEY (ID_TIPO_PENALIDAD) REFERENCES TIPO_PENALIDAD(ID_TIPO_PENALIDAD)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go




ALTER TABLE SERVICIO
	ADD CONSTRAINT R_11 FOREIGN KEY (ID_LINEA_SERVICIO) REFERENCES LINEA_SERVICIO(ID_LINEA_SERVICIO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go




ALTER TABLE SOLICITUD
	ADD CONSTRAINT R_40 FOREIGN KEY (ID_CONTRATO) REFERENCES CONTRATO(ID_CONTRATO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go


